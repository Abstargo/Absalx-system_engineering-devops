#!/bin/bash

# Function to get subdomain information
get_subdomain_info() {
    local domain=$1
    local subdomain=$2

    # Retrieve DNS record details using dig
    record=$(dig +short "${subdomain}.${domain}")

    if [ -z "$record" ]; then
        echo "The subdomain ${subdomain} does not exist."
        return
    fi

    # Determine the record type
    record_type=$(dig +short -t ANY "${subdomain}.${domain}" | awk '{print $4}' | head -n 1)

    # Output the result
    echo "The subdomain ${subdomain} is a ${record_type} record and points to ${record}"
}

# Main script logic
main() {
    local domain=$1
    local subdomain=$2

    if [ -z "$domain" ]; then
        echo "Domain parameter is mandatory"
        exit 1
    fi

    if [ -z "$subdomain" ]; then
        # Default subdomains to check
        subdomains=("www" "lb-01" "web-01" "web-02")
        for sub in "${subdomains[@]}"; do
            get_subdomain_info "$domain" "$sub"
        done
    else
        get_subdomain_info "$domain" "$subdomain"
    fi
}

# Ignore shellcheck case SC2086
main $@

